#!/usr/bin/env bb

(require '[clojure.java.shell :as shell])
(require '[clojure.string :as str])

(def ^:dynamic *prefix* nil)

(defn sh
  [cmd & args]
  (if *prefix*
    (apply shell/sh *prefix* cmd args)
    (apply shell/sh cmd args)))

(defn network-menu
  []
  (let [devices (sh "nmcli" "-t" "d")]
    devices))

(binding [*prefix* "distrobox-host-exec"]
  (-> (network-menu)
      :out
      (str/split-lines)
      (->> (map (fn [line]
                  (take 3 (str/split line #":"))))))
  )
